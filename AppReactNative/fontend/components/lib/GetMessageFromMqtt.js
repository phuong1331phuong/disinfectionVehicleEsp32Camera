
/** @format */

import React, { useState, useEffect, useRef } from "react";
import axios from "axios";
import { Image } from "react-native";
import { Button, VStack, Text, Center, Box } from "native-base";
// import Paho from 'paho-mqtt'

export default function Message() {
	const [message, setMessage] = useState(
		"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAAAAAAAD/2wBDAB4VFxoXEx4aGBoiIB4kLUsxLSkpLVxCRTZLbWBycWtgaWd4h62SeICjgWdplsyYo7K4wcPBdJDU49K84a29wbr/2wBDASAiIi0nLVgxMVi6fGl8urq6urq6urq6urq6urq6urq6urq6urq6urq6urq6urq6urq6urq6urq6urq6urq6urr/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/wAARCAHgAoADASEAAhEBAxEB/9oADAMBAAIRAxEAPwCCkqjMKKACikAUUAFFMAooAKKACigAqvcJkbh+NIpFakpFCUUAFLQAUlABS0AFJQAUUAFFABRQAUUAFFABRQAlLQAUlABRQMKKBBSUAFFACUUAFFABSUAFFABRQAUUAFFABSUALSUAFFABRQAUUAFFAGzRTMwpKBhRQIKKYBRQAUUgCimAUUgCkPIxTGUXXa2KZUlhRQAUUAFFABRQAUlABRQAUUAFFABRQAUUAFFABRQAlFABRQMKKBCUUAFFACUUAFJQAtJQAUUAFFABSUALRQAUUAJRQAUUAFFABRQAUUAbNJVGYUUAFFABRQAUUAFFABRQAUUhhRTAguU+XcB9aqVJaCigAooAKSgBaKACigAooASloASigAooAKKACigAooAKKAEooAKKACkoAKKAEooGJS0CEooAKKACigAooAKKACkoAKKACigAooAKKACigDZopkCUUCCigAopgLSUAFFAC0lIAopjClpAIeRzWe67SVoGhtFIoKKACigAooAKKACigBKWgAooASloASigAooAKKACkoAKKACigBKKACkoAKKACigBKKACigAooAKKBhRQISigBaSgAooAKKACigAooA2aKZAlFAgopAFFMAopjClpAJRTEFLQAlFABUFymfm/OkNFSikWFFABRQAUUAFFABSUALRQAfhS7W/umgA2N/dNL5b/AN2gQvlSf3aPJk9KAuL5D0eQ/tTsFxfs7f3hSeR/tUBcTyqPLoGJtpNtIBMU2gApKACkoAKKACigBKKACigAooAKKBiUtAhKWgBKKACigAooAKKACigDZopmYlFMAopAFFAC0lABS0AFFAwooAKSgQUGgZU+yvngrinfZT/fFBVw+yn++v5Uv2X/AG6AuH2Yf3jS/Zk9WoFzC/Zo/wDa/Oj7OnvQAvkR/wB3NHkRf88xTAXyk/uLS7F/uL+VAhce1LQAZPrRzSASimAlFABRQAlNoAYabSKGmm0DGmmmkAlJQAUUAJRQAUUAJRQAUUAFFABRQAUlAC0lABRQAUUAFFABRQAUUAbNFUZhSUgCimAtFIAopgGKKAFpKACikAUUxhRQIKKBhRQAUUgEpaBCUUxhRQAUUgCkpgFFABSUAJRQAmRTSaQxmabmgY0mm0hjKSgBtFAwpKBBRQAUlABRQAUUAFFABRQAlFABRQAtJQAUUAFFABRQAUUAbVFMzEopjFpKBBS0DEooEFLQAUUhhRTAKSkIWimMKSkAUZpgJkUZoAN1JuFIA3Um6gA3UbqAE30m+gBN9HmUAN3+9G+mA3fRvoGJvo30gE3UmTQAnNNoGJTaQCUlAxKKACkoAKKACkoAKKACigApKAFpKAFpKACigAooAKKACigAooAKKANqiqICigQlFIAoyPWmAbhSbhQMN1JupAG6jfTAN9JvoATf70m/3pAG+k30AJvo30DE8yjzPamAnmUbqLCDcaMmgBOaPmpgGDRg0AG2jbQAbaNopAG2jApgGBRxQAUlIApM0xjc0maQxuabSGJSUgEooAKSgAooASigAooAKKACigAooASigAooAKKACigAooAKKACigDW8yk8ymQJ5lHmUwG76TfSAPMo3GnYBMmjLU7DF+ak+akIXDetG0+tMA2+9G2gQbKNtABtFG0UDDApcLQAcUcUCDijIoANw9aTcKBib6N1IBN9G6gA3Um+gBN1G40AJuo3UDEzS80AJzRg0AGDSY96QCYpKBiUlIYlJQAlFACUUAFFAwpKBBRQAUUAFFACUUAFFABRQAUUAFFABRQAUUAJRQBpbaXaK0IuGBRx6UCDijikAUZpgGaM0MA3Um6gA30m6kAbqTdQMNxo3UgDNJmgA5o5oAMGjaaBhtNG2gBdvuKTHvTEIQM/eo+T+9SAPl96X5fRqAFwOyNRt9IzTGGxv+eVL5b/3FpCF8t/9mjy2/vLQAbT/AM9BSbR3koATaneQ0bY/9qi4xMR/3TR+7/uUgE+X+4KbkegpDEzTc0DG02gBKKAEooAKKAEooAKKACigApKAFpKACigAooAKKACigAooAKKACigDQzRmrIEzRmgBKXmgA5owfSgQbaMe9Awx/tCj5R/FSAT5PWj5femMXj+61L9ENAgw3/POl2v2ioAXZL/dFLsk/wBmgA2P/wA9Fo2t/wA9hSEGz1mo2p/z0NAxNkXqaNsPoaADEP8Aco/d/wDPKgAyn/PJaXzP9laQWDzmo85/WgBPNf8AvUnmN60DE3H1NJmkMSimAUlIApKYBRQA2kpDEpKAEptACUUAJRQAUUAJRQAUUAFFACUtACUUAFFABRQAUUAFFABRQAUUAFJQBo4P9ylw39yrJDa57UuyT2oEHlt/fWl2f9NaQCbB3lo2p6tRcA2xejUYi/uUAHyf88lpdwHRFFK4C+YfajzW9aADzW/vUm9v7xoATefU0mT3oGJS0AJRQAUUhhSUxBRQMKKACkpCCimAUUgCkpjCikAlFABSUAJSUAJSUxiU2kAlJQAUUAFFACUUAFFABRQAUUAJRQAUUAFFABRQAUUAFFABRQAlFAGrvb1pu4+tMkTJpKBhS0CEpaACimAlFIApaQCUtACUUwCikAUlMYtJSEFFABRTGJRSEFFAwooAKKAEooAKSgAooASigBKSgYlJQAlNoAKSgBKKACigApKACigYUUCCkoAKKACigAooAKKAEpaACigBKKACigDSpKZIUUAFFIAopgFFIAooAKKACigYlLQIKSmAUUhhRQIKKAEooGFFMQUUhhSUwFpKQgpKYwopAJRQAUUAJSUAJSUDEpKAG0UAJRQAUUAJRQAUUAFFACUUAFFABRQAUUAFFABRQAUUAFJQAUUAaVJTEFFAgooAKKQBRQAUUxhRQIKKACkpAFFAwopgFJQIKKACikMKKACigApKACigBKKACkoAKKACkoAKSgBKSgYlJQAlJQAlFACUUDCigQUUAFFACUUAFFABRQAUUAFFABRQAUUAFFACUUAaNFMQUUCCigAopAFFMQUUDCikAUlABRTAKKQwooAKKAEooAKKACigBKKACigBKKACigApKACigApKACkoGJSUAJSUAJSUAJRQAlFABRQAUUAFJQAUUAFFABRQAUUAFFABSUAFFABRQAUUAaNFMkKKAEpaACkpALRTGFJQIKKBhS0gEooEFFAwooEJRQAUUDCigBKKACigAooAKSgApKACigApKACigYlFACUlACUlACUlACUUAFJQAUUAFFABSUAFFABRQAUUAFFABSUAFLQAlFABRQAUUAaNFMkKSgAooAKWgAopAJRTAKKACikMKKACigBKKYBRSAKKAEpaAEooAKKACigApKACkoAKKAEooAKKBiUUAJSUAJSUAJSUAJRQAUlABRQAUlABRQAUUAFFABRQAUUAFJQAUUAFFABRQAUUAaNJTEFFABRQAUUhBS0xiUUgCigQUUDCigApKACigAooAKKACigBKKACigBKKACigApKACkoAKKACkoAKSgYUlADaKAEpKAEooASigAooAKKAEpaAEooAKKACigAooASigBaSgAooAKKACigDRooEJRTEFFAwooEFFABRSGFFAhKWgAooGJRQAUUAFFABSUALSUAFFABSUAFFAgooGJRQAUUAJRQAUlAwooASkoAbRQAlJQAlFABSUAFFABRQAlFABRQAUUAFFABRQAlFABRQAUUAFFABRQBoUUyQooGFFIQUUAFFAwooAKKACigBKKBBRQMKKACigAooAKSgAooASigAooAKSgAooAKSgAooAKSgAooASkoGJSUAJSUAJRQAlFABRQAUUAJRQAUUAFFABRQAUlAC0lABRQAUUAFFABRQBoUVRIUVIBRQAUUAFFMYUUhBRQAUlAwpaAEooAKKACigApKACigAooAKSgAooAKKAEooGFFACUUCEooGFJQAlJQAUlACUlACUUAJRQAUUAJRQAUUAFFABRQAUUAFJQAUUAFFABRQAUUAFFAGhSUyRaSkMWigQUlAxaKYBRSAKKACigBKKACigQUUDCigAooASigAooAKSgAooAKKAEooGFFAhKKBiUUCCigBtFACUlAxKSgBKKAEooAKKAEpaAEooAKKACigAooASloASigAooAKKACigAooA0KSmIWkpAFFMQUUgFopgFFIAopjCigApKQBRQAUUAFFABRQAlFABRQAUUAJRQAUUAFJQMKKAEooASigAooENooASkoGJSUAJRQAlFABRQAUUAJRQAUUAFFABSUAFFABRQAUUAFFABRQAUUAaFJTELRSASloEJRQAUUDFooEFFABSUDCigAooAKKACigAooEFJQMKKACigApKACigBKKACigBKKACkoAKKBiU2gApKAEpKAEooASigAooAKSgAooAKKACigAooASigAooAKKACigAooAKKANCkpsQUUgCloEJRQAUUxi0UgCigQlLQMSigApaAEooAKKACigBKKACigAooASigAooASigAooAKSgAooGJSUAFJQAlJQAlJQAlJQAUUAFFACUUAFFABRQAUUAFJQAUtACUUAFFABRQAUUAFFAF+igQUUAFLQAlFABRQAUUAFFAgooGFFAgpaBhSUAFFABRQAlFABRQAUUAJRQAUUDCkoEFFABSUAFJQMKSgApKAEpKAEpKAEpKACigApKACigAooAKKACigAooAKSgAooAKKACigAooAKKAL9FUSFFSAUUDCimAUUAFFABRSAKKACigApaACkoAKKACigBKKACigAooAKSgApKACigYUlAgooASigApKBhSUAJSUAJRQAlJQAlFABRQAlFABRQAUUAFFACUUAFLQAlFABRQAUUAFFABRQBfopiCikAlLTEFFABRSGFFMAopAFFABRQAUUAFFABRQAlFAhaSgYUUAFFACUUAJSUDCigAooEJRQAUlAwooAKSgBKSgBKKAEpKAEooAKSgAooAKKACigApKACigAooAKKACigAooAKKACigC/RTEFFABRSEFFMYUUAFFIAooAKKACigAooAKKACigAooEFJQMKKACigBKSgApKBiUUCCigYlLQISigYUUAJRQAlJQAlFACUlACUUAJRQAUUAFFABRQAUlAC0lABRQAUUAFFABRQAUUAFFAF+imIKSgBaKQBRTEFFIYUUAFLQAlFABRQAtJQIWkoGFFABRQAUUAJRQAlFABRQA2igBKSgYUUAFFACUUAFFACUUAFJQAUlACUlACUlABRQAUUAFFABRQAlLQAlFABRQAUUAFFABRQAUUAFFAF+imIKKQBRTEFFIAooGFLQISlpgJRSGFFAC0lABRQAUUAFFAhKKBhSUAFFABSUAFJQAlJQMKSgAooAKKAEooAKSgApKACigBKSgBKSgAooAKKACigAooAKSgAooAKKACigAooAKKACigAooAv0lMQUUgFooEFFMYUUAFFIAooEFLQMSigQUUDCigApKACigAooAKSgAooEFJQMKSgBKSgYlFACUUAFFACUUAFJQAUUAFJQAUlACUlABRQAUUAFFABSUALSUALSUAFFABRQAUUAFFABRQAUUAX6KBBSUCFooAKKYwopAFFMApaAEopAFFAgooAKKBhSUAFFAgooGFFACUUAFJQAlFAxKSgBKSgBKKACigAooASigApKACigBKKAEpKACigAooAKKACigBKKACigAooAKKACigAooAKKACigC/RTJCkpALSUAFLTAKKACikAUUDCimAUUAFFIApKACigAooAKKACkoAKKACkoAKSgBKSgYlJQAlFACUUAFFABSUAFFACUUAFJQAUlABRQAUUAFFABRQAlFABRQAUUAFFABRQAUUAFFABRQBfpKYgopCCloASloAKKBhRQIKKBhRQIKKBhRQAUlABRQAUUAFJQAUUAFFABSUAFJQMSkoASkoASkoAKSgAooAKSgAooAKSgAooAKSgAooAKKACigApKACigAooAKKACigAooAKKACigAooAv0lMQtJSEFFABS0AFFABRTGFFIAooASigApaACkoAKKBBSUDCigAooAKKACkoAKSgBKSgYlJQAlJQAlJQAUUAFFABSUAFFABSUAFFABRQAUUAJRQAUUAFFABRQAUUAFFABRQAUUAFFABRQBeooEFFMQUtIYlLTAKKQBRQAUUCCigYlLQAlLQAlFABRQAUlABRQAUUAFJQAUUAFJQAUlADaSgYlJQAlJQAUUAJRQAUUAFJQAUUAFFABRQAUUAFFABSUAFFABRQAUUAFFABRQAUUAFFABRQBeopiCikIKKACigYUtABRQAlFABRQAUUAFFABRQAUUAFJQAUUAFFABRQAlFABRQAlJQMbSUAJSUAJSUAFJQAUUAFFABSUAFFABRQAUUAFFABSUAFFABRQAUUAFFABRQAUUAFFABRQAUUAXqKBBRQIKKBhRTAKKQBRTEFFABRSGFFABRQAUUAFFABSUAFFABRQAlFABRQAUUAJSUDEpKAG0lACUlACUUAFFACUUAFFABRQAUUAFFABRQAlLQAlFABRQAUUAFFABRQAUUAFFABRQAUUAXqKZIUUhhRQAUUAFFMAopAFFAgooAKKYwopAFFABRQIKSgYUUAFFACUUAFFABRQAlJQAlJQAlJQMSkoASkoAKSgBaSgAooAKKACigAooAKKACkoAKKACigAooAKKACigAooAKKACigAooAvUUCCigAooEFFABSUxi0UhBRTGFFIAooAKKACigQUUDEooAKKACigApKACigAooASkoGJSUAJSUAJSUAJSUAFFACUUAFFABRQAUUAFFABRQAlFABRQAUUAFFABRQAUUAFFABRQAUUAFJQBfooEFJTEFLSASloGJS0AFFMQUUhhRQIKKBhSUALRQAUlABRQAUUAFFABRQAlFABSUAFJQAlFAxtJQAlJQAlJQAUUAJRQAUUAFFABRQAUUAFFACUUAFFABRQAUUAFFABRQAUUAFFABRQAUlAF+imIKSkIWigBKKBi0lAC0UCCimAlLSGFFAhKKBi0lABRQIKKBhRQAUUAJS0AJRQAUlABSUAJSUDCm0AJSUAJSUAFFACUUAFFABRQAUUAFJQAtFACUUAFFABRQAUUAFFABRQAUUAFFACUUAFFAF+imISlpAJS0CEooGLRQAUlAC0UCCigYUUCEooGFFABRQAUUAFFAgpKBhS0AJRQAUlABSUAJRQMSkoASkoAbSUAFJQAUUAFFABRQAUUAFFABSUAFFABRQAUUAFFABRQAUUAFJQAtFABRQAUlAF6igQtJQAUUCCloGJRQIKKBhRQAtJQAUUAFFABRQIKKBhRQAUUAFJQAtJQAUUAFJQAUlACUlAxKKAEpKAEpKAEooASigAooAKKACigAooAKSgAooAKKACigAooAKKACigAooAKKAEpaACigC9RQSJRQAtJQAUUALRQAlFAwooAKKBBRQMKKACigAooAKKACigApKACigApKACigApKAEpKBiUUAJSUAJSUAJSUAFFABRQAUUAFFABSUALSUAFFABRQAUUAFFABRQAUUAFFABRQAlLQAUUAXqSgQUUAFFAgooAKWgYlFMQUUgCigAooGFFABRQAUUAFFACUUAFFABRQAUUAJRQAUlACUlAxKKAEpKAEpKAEooASigAooAKKACigBKKAFpKACigAooAKKACigAooAKKACigAooAKKAEpaAL1JTJCikMKKYgooAKKQwooAKKBBRQMKKACigAooAKKACikAlFMAooAKKACkoAKKACkoAKbQAlFAxKSgBKSgBKKAEooAKKACigAooASigAooAKKACigAooAKKACigAooAKKACigAooASloAvUlMkKKACikAUlAC0UAFFABRTAKKQBRQMKKACigQUUDEooAKKACigApKACigAooAKSgAptABSUDEpKAEpKACkoASigAooAKKACigBKWgApKACigAooAKKACigAooAKKACigAooAKKACkoAv0UyRKKQBRTAKKQBRTAKKACikAUlMYtFIQUlAC0lAwooAKKACkoAWkoAKKACigAooAKSgApKAEpKAEpKBiUlABSUAJRQAUUAFFACUUAFFAC0lABRQAUUAFFABRQAUUAFFABRQAUUAFFABRQBepKCQooGFFAgooAKKBhSUALRQAlFAgooAKKBhSZoAM0ZoAbupN1Aw3UbqADNGaBBmloGOooEFFABRQAlJQAlJQMSkoASkoAKSgBKKACigAooAKKAEooAKKACigAooAKKACigAooAKKACigAooAKKACkoAv0lMQUUhBRQAUUAFFAxKWgBKWgQlFABRQAZphcUDGb6buoGG6jNACUUAFLmgAzRmgBc08UAOpaBBRQAUUAJSUAJRQMbSUAJSUAFJQAlFABRQAUUAJRQAUUAFFABRQAUUAFFABRQAUUAFFABRQAUUAFFACUUAX6SgkKKAEpaBhSUxC0lABRSAKKACkzQMTdTTJ6UDIyc02gAooAKKACigAooAKKAHCnZoAdTqAFooEJS0AJSUAJRQMbSUAJRQAlJQAlFABRQAUUAFJQAUUAFFABRQAUUAFFABRQAUUAFFABRQAUUAFFABRQBdopkhSUAFFIYUUCCimMKKQgphegZHvNNzQMKSgAooAKKACigAooASloASloAKWgB2aduoAcDTqBBSUAFJQAlJQMKSgBKSgBKSgBKKACigAooAKSgAooAKKACigAooAKKACigAooAKKACigAooAKKACkoAvUUCCigQUUAJS0AJRQMKQmgCJjTKBhSUAFFABRQAUUAFFABRQAUUAJRQAtFABRQA8GnigQ6igApKACm0AFJQMSkoASkoASigAooAKKACigBKKACigAooAKKACigAooAKKACigAooAKKACigAooAu0UCCkoELSUAFFABRQAVExoKRHRQAlFABRQAUUAFFABRQAUUAFFABSUALSUAFLQAVIDQA8UtAgooASkoGJSUAJSUAJSUAJRQAUUAFJQAtFACUUAFFABRQAUUAFFABRQAUUAFFABRQAUUAFFABSUAXqKCQooGJRQIKKBhRQA0moTQMSkoAKKACigAooAKKACigApKAFpKACigAooAKKACnCgCQU6gQtJQAUlAxKSgBKSgBKKAEpKACigApKACigAooAKKACigAooAKKACigAooAKKACigAooAKKACkoAvUUCCkoAKKBBRTAKSkBGxqOgoSigAooAKKACigAooGJS0CCkoAWkoAKKACigAooAKWgBwNSCgBaKBBSUDEpKAEpKAEpKACkoAKKACkoAWkoAKKACigAooAKKACigAooAKKACigAooAKKACigApKAP/2Q=="
	);
	const [key, setKey] = useState(1);
	const stream = useRef();
	const streamVideo = () => {
		axios
			.get("http://192.168.1.8:3001/mqtt")
			.then((res) => {
				if (res.data.toString() === "") {
				} else {
					setMessage(res.data.toString());
					setKey((key) => key + 1);
				}
				// console.log(message);
			})
			.catch((error) => console.log(error));
	};
	useEffect(() => {
		// stream.current.setNativeProps({
		// 	src: [message],
		// });
		// console.log(stream.current.setNativeProps);
		setInterval(streamVideo, 10);
	}, []);
	return (
		<Center>
			{/* <Text>{message}</Text> */}
			<Image
				alt='stream from esp32'
				ref={stream}
				source={{
					uri: message,
				}}
				key={key.toString()}
				style={{
					flex: 0.5,
					width: 320,
					height: 240,
				}}
			/>
			<Text>Get message</Text>
		</Center>
	);
}
